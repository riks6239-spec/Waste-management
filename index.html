<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Waste AI - Multi-Language</title>

    <link rel="stylesheet" href="style.css">

    <!-- TensorFlow.js & MobileNet -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@latest"></script>
</head>
<body>

<div class="card">
    <select id="langSwitch" class="lang-select">
        <option value="en">English</option>
        <option value="bn">à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)</option>
    </select>

    <h2 id="ui-title">Waste AI Explorer</h2>
    <p id="ui-subtitle">Empowering Campus Sustainability</p>

    <div id="video-container"><video id="webcam" autoplay playsinline muted></video></div>
    <img id="preview" src="" alt="Waste Preview">

    <div id="status">Initializing AI Engine...</div>

    <div class="btn-group">
        <button id="cameraBtn">Live Camera</button>
        <button id="uploadBtn" onclick="document.getElementById('fileInput').click()">Upload Photo</button>
    </div>
    <input type="file" id="fileInput" accept="image/*" hidden>

    <button id="actionBtn" disabled>Scan & Identify</button>

    <div id="resultBox" class="result-box">
        <div id="ui-label">AI Classification:</div>
        <div id="itemName">-</div>
        <div id="binType">-</div>
        <hr>
        <div id="ui-guide">Safe Disposal Instructions:</div>
        <div id="tip">-</div>
    </div>
</div>

<script>
const translations = {
    en: {
        title: "Waste AI Explorer", subtitle: "Empowering Campus Sustainability",
        camera: "Live Camera", upload: "Upload Photo", scan: "Scan & Identify",
        scanning: "Analyzing Patterns...", label: "AI Classification:",
        guide: "Safe Disposal Instructions:", status: "âœ… AI Ready",
        general: "GENERAL WASTE ðŸ—‘ï¸", generalTip: "Place in general waste. Avoid mixing with organics."
    },
    bn: {
        title: "à¦¬à¦°à§à¦œà§à¦¯ AI à¦à¦•à§à¦¸à¦ªà§à¦²à§‹à¦°à¦¾à¦°", subtitle: "à¦•à§à¦¯à¦¾à¦®à§à¦ªà¦¾à¦¸ à¦¸à§à¦¥à¦¾à¦¯à¦¼à¦¿à¦¤à§à¦¬ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤à¦•à¦°à¦£",
        camera: "à¦²à¦¾à¦‡à¦­ à¦•à§à¦¯à¦¾à¦®à§‡à¦°à¦¾", upload: "à¦›à¦¬à¦¿ à¦†à¦ªà¦²à§‹à¦¡", scan: "à¦¸à§à¦•à§à¦¯à¦¾à¦¨ à¦•à¦°à§à¦¨",
        scanning: "à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡...", label: "AI à¦¶à¦¨à¦¾à¦•à§à¦¤à¦•à¦°à¦£:",
        guide: "à¦¨à¦¿à¦°à¦¾à¦ªà¦¦ à¦¬à¦°à§à¦œà§à¦¯ à¦…à¦ªà¦¸à¦¾à¦°à¦£ à¦¨à¦¿à¦°à§à¦¦à§‡à¦¶à¦¿à¦•à¦¾:", status: "âœ… à¦à¦†à¦‡ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤",
        general: "à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¬à¦°à§à¦œà§à¦¯ ðŸ—‘ï¸", generalTip: "à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¡à¦¾à¦¸à§à¦Ÿà¦¬à¦¿à¦¨à§‡ à¦«à§‡à¦²à§à¦¨à¥¤ à¦ªà¦šà¦¨à¦¶à§€à¦² à¦¬à¦°à§à¦œà§à¦¯à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦®à§‡à¦¶à¦¾à¦¬à§‡à¦¨ à¦¨à¦¾à¥¤"
    }
};

let currentLang = 'en';
function updateUI(){
    const t = translations[currentLang];
    document.getElementById('ui-title').innerText = t.title;
    document.getElementById('ui-subtitle').innerText = t.subtitle;
    document.getElementById('cameraBtn').innerText = t.camera;
    document.getElementById('uploadBtn').innerText = t.upload;
    document.getElementById('actionBtn').innerText = t.scan;
    document.getElementById('ui-label').innerText = t.label;
    document.getElementById('ui-guide').innerText = t.guide;
    document.getElementById('status').innerText = t.status;
}
document.getElementById('langSwitch').onchange = e => { currentLang = e.target.value; updateUI(); }

let classifier;
async function setupAI(){
    classifier = await mobilenet.load();
    updateUI();
    document.getElementById('actionBtn').disabled = false;
}

document.getElementById('cameraBtn').onclick = async ()=>{
    const stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
    document.getElementById('webcam').srcObject = stream;
    document.getElementById('video-container').style.display='block';
    document.getElementById('preview').style.display='none';
}

document.getElementById('fileInput').onchange = e=>{
    const reader = new FileReader();
    reader.onload = ev=>{
        document.getElementById('preview').src = ev.target.result;
        document.getElementById('preview').style.display='block';
        document.getElementById('video-container').style.display='none';
    }
    reader.readAsDataURL(e.target.files[0]);
}

async function startAnalysis(){
    const actionBtn = document.getElementById('actionBtn');
    actionBtn.disabled = true;
    actionBtn.innerText = translations[currentLang].scanning;

    const source = document.getElementById('preview').style.display==='block' ?
                   document.getElementById('preview') : document.getElementById('webcam');

    const results = await classifier.classify(source);
    const topTags = results.map(r=>r.className.toLowerCase()).join(' ');
    const categories=[
        {keys:['keyboard','laptop','mobile','phone','battery','charger','electronics'], en:{name:"E-WASTE BIN ðŸ”Œ", tip:"Drop off at IT Hub."}, bn:{name:"à¦‡-à¦¬à¦°à§à¦œà§à¦¯ à¦¬à¦¿à¦¨ ðŸ”Œ", tip:"à¦†à¦‡à¦Ÿà¦¿ à¦¹à¦¾à¦¬à§‡ à¦œà¦®à¦¾ à¦¦à¦¿à¦¨à¥¤"}, color:"#4361ee"},
        {keys:['bottle','plastic','glass','cup','can','water bottle'], en:{name:"RECYCLABLE BIN â™»ï¸", tip:"Place in Blue bin."}, bn:{name:"à¦°à¦¿à¦¸à¦¾à¦‡à¦•à§‡à¦² à¦¬à¦¿à¦¨ â™»ï¸", tip:"à¦¨à§€à¦² à¦¬à¦¿à¦¨à§‡ à¦«à§‡à¦²à§à¦¨à¥¤"}, color:"#0056b3"},
        {keys:['fruit','vegetable','banana','food','bread','apple','peel'], en:{name:"ORGANIC BIN ðŸŽ", tip:"Compostable material."}, bn:{name:"à¦ªà¦šà¦¨à¦¶à§€à¦² à¦¬à¦¿à¦¨ ðŸŽ", tip:"à¦•à¦®à§à¦ªà§‹à¦¸à§à¦Ÿ à¦•à¦°à§à¦¨à¥¤"}, color:"#2d6a4f"},
        {keys:['shoe','boot','sneaker','sandal','slipper','flip-flop','cloth','fabric'], en:{name:"CLOTHING/DONATION ðŸ‘Ÿ", tip:"Donate if usable."}, bn:{name:"à¦ªà§‹à¦¶à¦¾à¦•/à¦œà§à¦¤à§‹ à¦¦à¦¾à¦¨ ðŸ‘Ÿ", tip:"à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦¯à§‹à¦—à§à¦¯ à¦¹à¦²à§‡ à¦¦à¦¾à¦¨ à¦•à¦°à§à¦¨à¥¤"}, color:"#7209b7"}
    ];

    let matched = categories.find(cat=>cat.keys.some(k=>topTags.includes(k)));
    const binDisplay = matched ? matched[currentLang].name : translations[currentLang].general;
    const tipDisplay = matched ? matched[currentLang].tip : translations[currentLang].generalTip;
    const finalColor = matched ? matched.color : "#555";

    document.getElementById('itemName').innerText = "Detected: "+results[0].className.split(',')[0];
    document.getElementById('binType').innerText = binDisplay;
    document.getElementById('binType').style.color = finalColor;
    document.getElementById('tip').innerText = tipDisplay;
    document.getElementById('resultBox').style.display='block';
    document.getElementById('resultBox').style.borderColor=finalColor;

    actionBtn.disabled = false;
    actionBtn.innerText = translations[currentLang].scan;
}

document.getElementById('actionBtn').onclick=startAnalysis;
setupAI();
</script>
</body>
</html>
